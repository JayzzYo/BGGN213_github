---
title: "Class10_Halloween_Project"
author: "Zixuan Zeng(A16142927)"
format: html
---

## Importing Data

```{r}
candy_file <- "candy-data.csv"

candy = read.csv(candy_file, row.names=1)
head(candy)
```

```{r}
dim(candy)
sum(candy$fruity)
```

>Q1. 85 types of candy

>Q2. 38 fruity candy types

```{r}
candy["Reese's Peanut Butter cup", ]$winpercent
candy["Kit Kat", ]$winpercent
candy["Tootsie Roll Snack Bars", ]$winpercent
```

## What is your favourite candy

>Q3. Reese's Peanut Butter cup, 84.18%

>Q4. 73.76%

>Q5. 49.65%


```{r}
library("skimr")
skim(candy)
```


>Q6. Winpercent seems to be on a different scale. All others are on a scale from 0 to 1 while winpercent is on 0-100.

>Q7. Does this candy contain chocolate or not

>Q8. Plot shown below

```{r}
library(ggplot2)
ggplot(candy) + aes(winpercent) + geom_histogram()
```

```{r}
win <- candy$winpercent
win.mean <- mean(win)
round(win.mean,2)
summary(candy$winpercent)
```


>Q9. The distribution seems a little skewed to the left. Most candies have a winpercent between 40 and 80.

>Q10. The center of the distribution seems to be below 50%. Median = 47.83

```{r}
mean(candy$winpercent[as.logical(candy$chocolate)]) > mean(candy$winpercent[as.logical(candy$fruity)])
```

>Q11. On average, the chocolate candy ranked higher than the fruity candy.

```{r}
t.test(candy$winpercent[as.logical(candy$chocolate)],candy$winpercent[as.logical(candy$fruity)])
```


>Q12. p-value is less than 0.05, indicating the difference is statistically significant. 


## Overall Candy Rankings

```{r}
head(candy[order(candy$winpercent),], n=5)
```

>Q13. The the five least liked candy types are Nik L Nip, Boston Baked Beans, Chiclets, Super Bubble, and Jawbusters.

```{r}
tail(candy[order(candy$winpercent),], n=5)
```

>Q14. The five most liked candy types are Reese's Peanut Butter cup, Reese's Miniatures, Twix, Kit Kat, and Snickers.

>I don't have a preference over these two approaches. Base r does not require loading additional packages, while dplyr provides a more streamlined syntax.

>Q15. Figure shown below

```{r}
library(ggplot2)

ggplot(candy) + aes(winpercent, rownames(candy)) + geom_col() 
```

>Q16. Figure shown below

```{r}
ggplot(candy) + aes(winpercent, reorder(rownames(candy),winpercent)) + geom_col() 
```



```{r}
my_cols=rep("black", nrow(candy))
my_cols[as.logical(candy$chocolate)] = "chocolate"
my_cols[as.logical(candy$bar)] = "brown"
my_cols[as.logical(candy$fruity)] = "pink"
ggplot(candy) + aes(winpercent, reorder(rownames(candy),winpercent)) + geom_col(fill=my_cols)
```

>Q17. Sixlets

>Q18. Starburst


## Taking a look at pricepercent

```{r}
library(ggrepel)

# How about a plot of price vs win
my_cols[candy$fruity==1] = "red"
ggplot(candy) +
  aes(winpercent, pricepercent, label=rownames(candy)) +
  geom_point(col=my_cols) + 
  geom_text_repel(col=my_cols, size=3.3, max.overlaps = 5)
```

>Q19. Reese's Miniatures

>Q20. Nik L Nip, Nestle Smarties, Ring pop, Hershey's Krackel, Hershey's Milk Chocolate

```{r}
ord <- order(candy$pricepercent, decreasing = TRUE)
head( candy[ord,c(11,12)], n=5 )
```

>Q21. Figure shown below

```{r}
# Make a lollipop chart of pricepercent
ggplot(candy) +
  aes(pricepercent, reorder(rownames(candy), pricepercent)) +
  geom_segment(aes(yend = reorder(rownames(candy), pricepercent), 
                   xend = 0), col="gray40") +
    geom_point()
```


## Exploring the correlation structure

```{r}
library(corrplot)
cij <- cor(candy)
cij
corrplot(cij)
```

>Q22. Chocolate and fruity 

>Q23. Chocolate and bar


## Principal Component Analysis

```{r}
pca <- prcomp(candy, center=TRUE, scale.=TRUE)
summary(pca)
```

```{r}
ggplot(pca$x) + aes(PC1,PC2, label=rownames(pca$x)) + geom_point(col=my_cols) + geom_text_repel(col=my_cols, size=3.3, max.overlaps = 7)
```


```{r}
plot(pca$x[,1:2], col=my_cols, pch=16)
```

```{r}
my_data <- cbind(candy, pca$x[,1:3])
p <- ggplot(my_data) + 
        aes(x=PC1, y=PC2, 
            size=winpercent/100,  
            text=rownames(my_data),
            label=rownames(my_data)) +
        geom_point(col=my_cols)

p
```

```{r}
p + geom_text_repel(size=3.3, col=my_cols, max.overlaps = 7)  + 
  theme(legend.position = "none") +
  labs(title="Halloween Candy PCA Space",
       subtitle="Colored by type: chocolate bar (dark brown), chocolate other (light brown), fruity (red), other (black)",
       caption="Data from 538")
```

```{r}
library(plotly)
ggplotly(p)
```

```{r}
par(mar=c(8,4,2,2))
barplot(pca$rotation[,1], las=2, ylab="PC1 Contribution")
```

>Q24. Fruity, hard, and pluribus are picked up strongly by PC1 in the positive direction. It makes sense as the first dimension separates fruity candies from chocolate candies. In the correlationn plot, we can also see that fruity candies only correlate with hard and pluribus.